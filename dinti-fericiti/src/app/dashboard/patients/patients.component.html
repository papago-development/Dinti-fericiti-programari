<div class="container">
  <div class="mat-elevation-z8">
    <mat-card>
      Pacienti
    </mat-card>
    <mat-form-field>
      <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Cautare">
    </mat-form-field>
    <table mat-table [dataSource]="dataSource" matSort>

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Nume pacient</th>
        <td mat-cell *matCellDef="let item">{{ item.name }}</td>
      </ng-container>

      <ng-container matColumnDef="phonePacient">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Telefon</th>
        <td mat-cell *matCellDef="let item">{{ item.phonePacient }}</td>
      </ng-container>
      <ng-container matColumnDef="medic">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Medic</th>
        <td mat-cell *matCellDef="let item">{{ item.medic }}</td>
      </ng-container>

      <!-- <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef>Editeaza</th>
        <td mat-cell *matCellDef="let item">
          <i class="material-icons" [routerLink]="['/patient/', item.id]">edit</i>
          <button class="button-text" mat-raised-button color="primary" id="addAppointment" (click)="openDialog(addContent, item.id)">
            Adauga programare
          </button>
          <button class="button-text-mobile" mat-raised-button color="primary" id="addAppointment" (click)="openDialog(addContent, item.id)">
              Programare
            </button>
        </td>
      </ng-container> -->
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
    <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
  </div>
</div>

<!-- Modal for adding a new appointment -->
<ng-template #addContent let-modal id="addModal">
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Adauga programare </h4>
    <button type="button" class="close" aria-label="Close" (click)="closeDialog()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <form [formGroup]="addAppointmentForm" (ngSubmit)="addAppointment()" id="addEvent">

    <input #input formControlName='id' hidden>

    <mat-form-field>
      <mat-label>Nume pacient</mat-label>
      <input matInput #input formControlName='namePacient' placeholder="Nume pacient">
      <mat-error *ngIf="!this.addAppointmentForm.controls.namePacient.valid">{{ getNamePacientErrorMessage() }}
      </mat-error>
    </mat-form-field>
    <mat-form-field>
      <mat-label>Telefon pacient</mat-label>
      <input matInput #input formControlName="phonePacient" maxlength="10" placeholder="Telefon pacient">
      <mat-error *ngIf="!this.addAppointmentForm.controls.phonePacient.valid">{{ getPhoneErrorMessage() }}</mat-error>
    </mat-form-field>
    <mat-form-field>
      <mat-label>Email pacient</mat-label>
      <input matInput #input formControlName="emailPacient" placeholder="Email pacient">
      <mat-error *ngIf="!this.addAppointmentForm.controls.emailPacient.valid">{{ getEmailErrorMessage() }}</mat-error>
    </mat-form-field>
    <mat-form-field>
      <mat-label>Manopera</mat-label>
      <input matInput #input formControlName="title" placeholder="Manopera">
      <mat-error *ngIf="!this.addAppointmentForm.controls.title.valid">{{ getSubjectErrorMessage() }}</mat-error>
    </mat-form-field>
    <mat-form-field>
      <mat-label>Medic</mat-label>
      <mat-select formControlName="medic">
        <mat-option *ngFor="let doctor of doctors" [value]="doctor.name">
          {{ doctor.name }}
        </mat-option>
      </mat-select>
      <mat-error *ngIf="!this.addAppointmentForm.controls.medic.valid">{{ getDoctorErrorMessage() }}</mat-error>
    </mat-form-field>
    <mat-form-field>
      <input matInput [owlDateTime]="dt1" formControlName="start" [owlDateTimeTrigger]="dt1" placeholder="Data start">
      <owl-date-time #dt1></owl-date-time>
      <mat-icon matSuffix>calendar_today</mat-icon>
      <mat-error *ngIf="!this.addAppointmentForm.controls.start.valid">{{ getStartErrorMessage() }}</mat-error>
    </mat-form-field>
    <mat-form-field>
      <input matInput [owlDateTime]="dt2" setClass="dt2" formControlName="end" pickerMode="dialog" [owlDateTimeTrigger]="dt2"
        placeholder="Data end">
      <mat-icon matSuffix>calendar_today</mat-icon>
      <owl-date-time #dt2></owl-date-time>
      <mat-error *ngIf="!this.addAppointmentForm.controls.end.valid">{{ getEndErrorMessage() }}</mat-error>
    </mat-form-field>
    <div class="form-group">
      <button id="add" mat-raised-button class="btn btn-success" type="submit"
        [disabled]="!this.addAppointmentForm.valid">Add</button>
    </div>
  </form>
</ng-template>
