<div class="container">
    <mat-card-title>
      Pacienti
    </mat-card-title><br>
  <mat-form-field>
    <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Cautare">
  </mat-form-field>
  <span id="addPatient">
    <button class="mr-auto" mat-raised-button (click)="addPatientPage()">Adauga pacient</button>
  </span>
  <table mat-table [dataSource]="dataSource" matSort>

    <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Nume pacient</th>
      <td mat-cell *matCellDef="let item">{{ item.name }}</td>
    </ng-container>

    <ng-container matColumnDef="phonePacient">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Telefon</th>
      <td mat-cell *matCellDef="let item">{{ item.phonePacient }}</td>
    </ng-container>
    <ng-container matColumnDef="medic">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Medic</th>
      <td mat-cell *matCellDef="let item">{{ item.medic }}</td>
    </ng-container>
    <ng-container matColumnDef="cnp">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>CNP</th>
      <td mat-cell *matCellDef="let item">{{ item.cnp }}</td>
    </ng-container>

    <ng-container matColumnDef="action">
      <th mat-header-cell *matHeaderCellDef>Editeaza</th>
      <td mat-cell *matCellDef="let item" id="action">
        <i class="material-icons" [routerLink]="['/patient/', item.id]">edit</i>
        <button mat-flat-button color="warn" id="deletePatient" #tooltip="matTooltip" matTooltip="Sterge pacient"
          (click)="deletePatient(item.id)">
          <span class="material-icons" id="delete-icon">
            delete
          </span></button>
        <button class="button-text" mat-raised-button color="primary" id="addAppointment"
          (click)="openDialog(addContent, item.id)">
          Adauga programare
        </button>
        <button class="button-text-mobile" mat-raised-button color="primary" id="addAppointment"
          (click)="openDialog(addContent, item.id)">
          Programare
        </button>

      </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
  <mat-paginator [pageSizeOptions]="[10, 15, 20]" showFirstLastButtons></mat-paginator>
</div>
<!-- </div> -->

<!-- Modal for adding a new appointment -->
<ng-template #addContent let-modal id="addModal">
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Adauga programare </h4>
    <button type="button" class="close" aria-label="Close" (click)="closeDialog()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <form [formGroup]="addAppointmentForm" (ngSubmit)="addAppointment()" id="addEvent">

    <input #input formControlName='id' hidden>

    <mat-form-field>
      <mat-label>Nume pacient</mat-label>
      <input matInput #input formControlName='namePacient' placeholder="Nume pacient">
      <mat-error *ngIf="!this.addAppointmentForm.controls.namePacient.valid">{{ getNamePacientErrorMessage() }}
      </mat-error>
    </mat-form-field>
    <mat-form-field>
      <mat-label>Telefon pacient</mat-label>
      <input matInput #input formControlName="phonePacient" maxlength="10" placeholder="Telefon pacient">
      <mat-error *ngIf="!this.addAppointmentForm.controls.phonePacient.valid">{{ getPhoneErrorMessage() }}</mat-error>
    </mat-form-field>
    <mat-form-field>
      <mat-label>Email pacient</mat-label>
      <input matInput #input formControlName="emailPacient" placeholder="Email pacient">
      <mat-error *ngIf="!this.addAppointmentForm.controls.emailPacient.valid">{{ getEmailErrorMessage() }}</mat-error>
    </mat-form-field>
    <mat-form-field>
      <mat-label>Manopera</mat-label>
      <input matInput #input formControlName="title" placeholder="Manopera">
      <mat-error *ngIf="!this.addAppointmentForm.controls.title.valid">{{ getSubjectErrorMessage() }}</mat-error>
    </mat-form-field>
    <mat-form-field>
      <mat-label>Medic</mat-label>
      <mat-select formControlName="medic">
        <mat-option *ngFor="let doctor of doctors" [value]="doctor.name">
          {{ doctor.name }}
        </mat-option>
      </mat-select>
      <mat-error *ngIf="!this.addAppointmentForm.controls.medic.valid">{{ getDoctorErrorMessage() }}</mat-error>
    </mat-form-field>
    <div class="form-group">
      <input id="input-start-date" class="form-control" [owlDateTime]="dt1" [min]="8" [max]="22"
        date-format="DD/MM/YYYY" formControlName="start" placeholder="Ora inceput">
      <span class="trigger" [owlDateTimeTrigger]="dt1">
        <i class="material-icons">calendar_today</i>
      </span>
      <owl-date-time #dt1 pickerMode="dialog"></owl-date-time>
    </div>

    <div class="form-group">
      <input class="form-control" [owlDateTime]="dt2" formControlName="end" placeholder="Ora sfarsit">
      <span class="trigger">
        <i class="material-icons" [owlDateTimeTrigger]="dt2">
          calendar_today
        </i>
      </span>
      <owl-date-time #dt2 pickerMode="dialog"></owl-date-time>
    </div>
    <div class="form-group">
      <button id="add" mat-raised-button class="btn btn-success" type="submit"
        [disabled]="!this.addAppointmentForm.valid">Adauga</button>
    </div>
  </form>
</ng-template>
